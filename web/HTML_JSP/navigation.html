<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <link rel="stylesheet" type="text/css" href="../CSS/settings.css">
    <link rel="stylesheet" type="text/css" href="../CSS/style.css">
    <script type="text/javascript">
        var user;
        var head_image ;
        var usertype ;
        var contextPath = getContextPath();
        function get_user_infor() {
            var dtd = $.Deferred();
            $.ajax({
                type: "POST",
                asynch: "false",
                url: contextPath+"/register",
                data: {
                    state:'user_infor'
                },
                dataType: 'json',
                success: function (jsonObj) {
                    head_image = cookie.get('head_image');
                    usertype = cookie.get('usertype');
                    user = jsonObj.user;
                    if (user===undefined){
                        $("#loginButton").show();
                        $('.personalCenter').remove();
                        return
                    }
                    if (jsonObj.read===0)  $('.msg_remind').css('display','inline');
                    checkCookie();
                    load_history();
                    card_show();
                    history_show();
                    dtd.resolve();
                }
            });
            return dtd;
        }

        function checkCookie() {
                $("#loginButton").remove();
                $(".personalCenter").show();
                $("#head_image").attr('src',contextPath+head_image);
        }

        var cookie = {
            set: function(name, value) {
                var Days = 30*12*5;
                var exp = new Date();
                exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
                document.cookie = name + '=' + escape(value) + ';expires=' + exp.toGMTString();
            },
            get: function(name) {
                var arr, reg = new RegExp('(^| )' + name + '=([^;]*)(;|$)');
                if(arr=document.cookie.match(reg)) {
                    return unescape(arr[2]);
                } else {
                    return null;
                }
            },
            del: function(name) {
                var exp = new Date();
                exp.setTime(exp.getTime() - 1);
                var cval = cookie.get(name);
                if(cval != null) {
                    document.cookie = name + '=' + cval + ';expires=' + exp.toGMTString();
                }
            }
        };

        $(document).ready(function(){
            search_tips();
            $("#search_input").blur(function(){
                setTimeout(function(){
                    $('.title_list_box').hide();
                },500)
            });
        });

        function load_history() {
            var load_history_class_id = cookie.get('class_id').toString().split(',');
            var load_schedule = cookie.get('schedule').toString().split(',');
            var load_last_time = cookie.get('last_time').toString().split(',');
            var load_title = cookie.get('class_title').toString().split(',');
            for (var i=0;i<load_history_class_id.length;i++){
                if ('0' === load_history_class_id[i])  continue;
                var unit = load_last_time[i].split(':');
                $('.history_ul').append(
                    '   <li  style="width: 100%;text-align: left;line-height: 10px">\n' +
                    '                        <a href="Play.html?'+load_history_class_id[i].trim()+'/'+unit[0].trim()+'" target="_blank" title="'+load_last_time[i].trim()+'" class="clearfix">\n' +
                    '                            <div class="link">'+load_last_time[i].trim()+'</div>\n' +
                    '                            <div style="float: right">\n' +
                    '                                <div class="state" style="display: inline;">\n' +
                    '                                    <span class="page">'+load_title[i]+'</span>\n' +
                    '                                    <span class="split">|</span>\n' +
                    '                                    <span>'+load_schedule[i]+'%</span>\n' +
                    '                                </div>\n' +
                    '                            </div>\n' +
                    '                        </a>\n' +
                    '                    </li>'
                )
            }
        }

        function history_show() {
            var timeout = null;
            var history_card = $(".history");
            history_card.mouseover(function(){
                $("#history_card").show();
                if( timeout != null ) clearTimeout(timeout);
            });

            history_card.mouseout(function(){
                timeout = setTimeout(function(){
                    $("#history_card").hide();
                },1000);
            });
        }
        
        function card_show() {
            var timeout = null;
            var user_card = $(".user");
            user_card.mouseover(function(){
                $("#user_card").show();
                if( timeout != null ) clearTimeout(timeout);
            });

            user_card.mouseout(function(){
                timeout = setTimeout(function(){
                    $("#user_card").hide();
                },1000);
            });
        }

        function search() {
            var keyword = $('#search_input').val();
            if (keyword.trim()==='') return;
            window.open(contextPath+'/HTML_JSP/Search/video.html?keyword='+encodeURI(keyword),'_blank');
        }
        
        function search_tips() {
            $('.title_list_box').hide();
            var timeout;
            $('#search_input').keyup(function(){
                clearTimeout(timeout);
                var keyword = $('#search_input').val();
                if(keyword==='') return;
                var data = {
                    Read_or_Save:'search_tips',
                    keyword:keyword
                };
                timeout = setTimeout(function() {
                    $.ajax({
                        type:"POST",
                        url:contextPath+"/SaveClassInfor",
                        data:data,
                        success:function(html){
                            var title_list_box = $('.title_list_box');
                            var title_list = $('.title_list');
                            if (html==='') {
                                title_list_box.hide();
                                return;
                            }
                            title_list_box.show();
                            title_list.html(html);
                            var list_tips = $('.list_tips');
                            list_tips.hover(
                                function(){
                                    $(this).addClass('hover');
                                },
                                function(){
                                    $(this).removeClass('hover');
                                }
                            );
                            list_tips.click(function(){
                                $('#search_input').val($(this).text());
                                $('.title_list_box').hide();
                            });
                        }
                    });
                }, 600);
                return false;
            });
        }
    </script>
    <title></title>
</head>
<body>
<div class="boxed">
    <div id="header" class="bg-fff style1">
        <div class="container">
            <div class="header-wrap clearfix">
                <div id="logo">
                    <a href="index.html"><img src="../image/HUAS.png" alt="bookflare" width="157px" height="29px" data-retina="../image/HUAS.png" data-width="157" data-height="29"></a>
                </div>
                <div class="nav-wrap style1">
                    <nav id="main-nav">
                        <ul class="menu" >
                            <li class="active">
                                <a href="#">首页</a>
                            </li>
                            <li>
                                <a href="#">课程类型</a>
                                <ul class="submenu">
                                    <li><a target="_blank" href="course.html?type=1">前端设计</a></li>
                                    <li><a target="_blank" href="course.html?type=2">后台开发</a></li>
                                    <li><a target="_blank" href="course.html?type=3">移动开发</a></li>
                                    <li><a target="_blank" href="course.html?type=4"> 嵌入式</a></li>
                                    <li><a target="_blank" href="course.html?type=5"> 基础理论</a></li>
                                    <li><a target="_blank" href="course.html?type=6" > 项目发布</a></li>
                                </ul>
                            </li>
                        </ul>
                    </nav>
                </div>
                <div class="extra-menu flat-text-right clearfix">
                    <div class="wrap-search-header">
                        <div class="search-header">
                            <form>
                                <input type="search" name="key" placeholder="Search for Courses">
                                <button class="btn-search"><span class="icon-search"></span></button>
                            </form>
                        </div>
                    </div>
                    <div class="cart nav-top-cart-wrapper personalCenter">
                        <a style="line-height: 50px;">
                            <img id="head_image" class="user_imag user"  src="../image/11f5dbcf9ad6ae261aa1656dd78004d9.jpg">
                        </a>
                        <div class="nav-shop-cart" style="width: 138px">
                            <div class="widget_shopping_cart_content">
                                <div class="woocommerce-min-cart-wrap">
                                    <ul class="woocommerce-mini-cart cart_list product_list_widget flat-text-center">
                                        <li class="woocommerce-mini-cart-item mini_cart_item">
                                            <a target="_blank" href="PersonalCenter.html" class="pc_item">个人中心</a>
                                        </li>
                                        <li class="woocommerce-mini-cart-item mini_cart_item">
                                            <a href="javascript:void(0);" onclick="deleteCookie()" class="pc_item">退出登录</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cart nav-top-cart-wrapper" id="loginButton" style="display:none">
                        <a data-toggle="modal" data-target="#LoginModal" href="#" style="font-weight: 700;">登录/注册</a>
                    </div>
                    <div class="cart nav-top-cart-wrapper personalCenter" >
                        <a href="#">
                            <span class="fa fa-bell"></span>
                        </a>
                        <span class="count-cart">0</span>
                    </div>
                    <div class="cart nav-top-cart-wrapper personalCenter" style="margin-right:15px;" >
                        <a href="#"><span class="fa fa-history"></span></a>
                        <div class="nav-shop-cart">
                            <div class="widget_shopping_cart_content">
                                <div class="woocommerce-min-cart-wrap" style="padding-top: 20px">
                                    <ul class="woocommerce-mini-cart cart_list product_list_widget flat-text-center history_ul"></ul>
                                </div><!-- /.widget_shopping_cart_content -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mobile-button">
                    <span></span>
                </div>
            </div>
        </div>
    </div> <!-- #header -->
</div>
<!--<div class="user_navigation">
    <ul class="nav nav-pills" style="display: inline">
        <li>
            <img id="logo" src="../image/HUAS.png" style="height: 40px;width: 40px;float: left;margin-right: 21px" alt="湖南文理图标">
        </li>
        <li class="nav-item">
            <a class="nav-link" href="homepage.html" style="float: left;">首页</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="Resources.html" style="float:left;">文档</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="course.html" style="float:left;">课程类型</a>
        </li>
        <li class="nav-item">
            <div class="input-group mb-3">
                <label for="search_input"></label>
                <input id="search_input" type="text" class="form-control" placeholder="搜索">
                <div class="input-group-append">
                    <i class="fa fa-search" onclick="search()"></i>
                </div>
                <div class="title_list_box">
                    <ul class="title_list"></ul>
                </div>
            </div>
        </li>
        <li class="nav-item" id="loginButton" style="display: none;">
            <a class="nav-link" data-toggle="modal" data-target="#LoginModal" style="float: right;" href="">登录</a>
        </li>
        <li class="nav-item" id="personalCenter" style="display: none;float: right;position: relative;">
            <img id="head_image" class="user_imag user"  alt="用户头像" src="">
            <div class="user_card user" id="user_card">
                <div style="padding: 20px;">
                    <a href="PersonalCenter.html" target="_blank">个人中心</a>
                    <a href="homepage.html" onclick="deleteCookie()">退出登录</a>
                </div>
            </div>
            <a class="notice" id="notice" target="_blank" href="notification.html">
                <i class="msg_remind"></i>
                <i class="fa fa-bell"></i>
            </a>
            <a class="notice history" target="_blank" href="javascript:void(0)">
                <i class="fa fa-history"></i>
            </a>
            <div class="history-record-m mini-wnd-nav history-wnd dd-bubble history" id="history_card">
                <ul class="history_ul"></ul>
            </div>
        </li>
    </ul>
</div>-->
</body>
</html>
